apiVersion: v1
kind: Pod
metadata:
  name: jaxy-bench
  namespace: aeldeib-dev
spec:
  restartPolicy: Never
  containers:
    - name: bench
      image: python:3.12-slim
      command:
        - bash
        - -c
        - |
          pip install jax==0.9.0.1 tensorstore==0.1.81 tqdm==4.67.3 && python /app/main.py
      env:
        - name: JAX_PLATFORMS
          value: cpu
      envFrom:
        - secretRef:
            name: jaxy-aws-creds
      volumeMounts:
        - name: script
          mountPath: /app
          readOnly: true
      resources:
        requests:
          memory: "32Gi"
          cpu: "4"
        limits:
          memory: "32Gi"
          cpu: "4"
  volumes:
    - name: script
      configMap:
        name: jaxy-script
